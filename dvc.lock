schema: '2.0'
stages:
  download_data:
    cmd: python src/download_data.py
    params:
      params.yaml:
        data.raw_dir: data/raw
        data.url: 
          https://drive.google.com/uc?id=1YlvpDLix3S-U8fd-gqRwPcWXAXm8JwjL
        data.zip_file: data.zip
    outs:
    - path: data/raw/data.zip
      hash: md5
      md5: ea944b389e49839817bb433f624c9078
      size: 423447196
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw/data.zip
      hash: md5
      md5: ea944b389e49839817bb433f624c9078
      size: 423447196
    - path: src/preprocess.py
      hash: md5
      md5: 31398e73d3b67838e2d64c7387cf0129
      size: 3235
    - path: src/utils.py
      hash: md5
      md5: 1db217f677ef36ef896d136fc8578d8e
      size: 1299
    params:
      params.yaml:
        data.raw_dir: data/raw
        data.tfrecord_file: data/processed/lipread_data.tfrecord
        data.zip_file: data.zip
    outs:
    - path: data/processed/lipread_data.tfrecord
      hash: md5
      md5: 34391ee91736b8f10f0b5f925edcccc1
      size: 1932173840
  train:
    cmd: python src/train.py
    deps:
    - path: data/processed/lipread_data.tfrecord
      hash: md5
      md5: 34391ee91736b8f10f0b5f925edcccc1
      size: 1932173840
    - path: src/train.py
      hash: md5
      md5: 123f4f8b87ebebbab2e8eacae711aee7
      size: 5757
    - path: src/utils.py
      hash: md5
      md5: 1db217f677ef36ef896d136fc8578d8e
      size: 1299
    params:
      params.yaml:
        model:
          input_shape:
          - 75
          - 46
          - 140
          - 1
          padded_shapes:
            frames:
            - 75
            - 46
            - 140
            - 1
            alignments:
            - 40
        train:
          training: false
          weight_url: 
            https://drive.google.com/uc?id=1iLrOT5D1TED4zCit6yuM1Rq37sybtX7g
          epochs: 20
          batch_size: 2
          learning_rate: 0.0001
          checkpoint_path: models/lipread_model.weights.h5
    outs:
    - path: models/lipread_model.weights.h5
      hash: md5
      md5: c346b28cc69634734e7f55bdf0ab2bf8
      size: 33942880
